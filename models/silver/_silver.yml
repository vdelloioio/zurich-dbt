version: 2

models:
  - name: ordini_ripulita
    config: 
      materialized: incremental
      unique_key: 
        - 'id_ordine'
    description: Tabella degli ordini. Primary Key id_ordine
    columns:
      - name: id_ordine
        constraints:
          - type: not_null
          - type: primary_key
        data_type: integer
        description: Primary key, id dell'ordine
      - name: id_persona
        data_type: integer
        description: id della persona che ha fatto l'acquisto
        constraints:
          - type: foreign_key
            expression: "(id_persona) REFERENCES persone_scd2 (id_persona)"
      - name: importo
        data_type: float
        description: importo dell'ordine
        tests:
          - not_null
  - name: persone_ripulita
    config: 
      materialized: incremental
      unique_key: 
        - 'id_persona'
    description: Tabella degli delle persone. Primary Key id_persona
    columns:
      - name: id_persona
        data_type: integer
        description: Primary key, id della persona
        constraints:
          - type: not_null
          - type: primary_key
      - name: nome
        data_type: string
        description: nome della persona che ha fatto l'acquisto
        tests:
          - not_null
      - name: cognome
        data_type: string
        description: cognome della persona che ha fatto l'acquisto
        tests:
          - not_null